{% extends '::base.html.twig' %}

{# ------------------------------------------------------------------------ #}
{% block body %}
    <div class="blocksection w" id="f-section">
        <div class="filter checks-filter" style="width:23.7%">
            <div class="title dark-green-title title-filter">
                <h2>Фильтрация</h2>
            </div>
            <form id="atlas-filter-form" class="atlas-filter-form" action="{{ path('armd_atlas_default_filter') }}" method="POST">

                <input id="category-id" type="hidden" name="category" value="">

                <div class="simple-search">
                    <label for="ss_input">Поиск адреса</label>
                    <input type="text" class="ss-input" id="ss_input" />
                </div>

                {% for category in categories %}
                    <div class="simple-filter-block">
                        <div class="simple-filter-header clearfix">
                            <span>{{ category.title }}</span>
                            <p class="check_all"><span>все</span></p>
                        </div>
                        <div class="simple-filter-options">
                            {% for tag in category.tags %}
                                <label class="tag gray-checked disabled">
                                    <span data-tag="{{ tag.id }}">{{ tag.title }}</span>
                                </label>
                            {% endfor %}
                        </div>
                    </div>
                {% else %}
                    No categories found.
                {% endfor %}

            </form>
        </div>
        <div class="atlas-center">
            <div class="title green-title">
                <h2>Атлас</h2>
            </div>
            <div class="atlas-map" style="margin-top:-10px;">
                <div id="map"></div>
                {# <div class="atlas-menu"></div> #}
                <div id="regions-selector" class="regions-selector">
                    <select data-placeholder="Выберите регион..." class="chzn-select">
                        <option></option>
                    </select>
                </div>
                <div id="ajax-loading" class="ajax-loading"></div>
            </div>
        </div>
    </div>

    <!-- Асинхронная загрузка jsapi -->
    <div id="script_block" class="script_block"></div>
    <div id="script_ad" class="script_ad" style="display:none;">
        <script type="text/javascript" charset="utf-8" src="http://js.tmcrussia.com/map.js?{{ progorod_api_key }}&version=0.1.8-rc2"></script>
    </div>
    <script type="text/javascript">
        document.getElementById('script_block').appendChild(document.getElementById('script_ad'));
        document.getElementById('script_ad').style.display = 'block';
    </script>
    <!-- /Асинхронная загрузка jsapi -->
{% endblock %}

{# ------------------------------------------------------------------------ #}
{% block stylesheets %}
    {{ parent() }}
    <link rel="stylesheet" href="{{ asset('bundles/armdatlas/css/chosen.css') }}">
    <link rel="stylesheet" href="{{ asset('static/common/css/atlas.css') }}">
    <link rel="stylesheet" href="{{ asset('bundles/armdatlas/css/atlas_new.css') }}">
{% endblock %}

{# ------------------------------------------------------------------------ #}
{% block javascripts %}
    {{ parent() }}
    <script src="//ajax.googleapis.com/ajax/libs/jqueryui/1.8.18/jquery-ui.min.js"></script>
    <script type="text/javascript" charset="utf-8" src="http://js.tmcrussia.com/?{{ progorod_api_key }}&version=0.1.8-rc2"></script>
    <script type="text/javascript" src="{{ asset('bundles/armdatlas/js/jquery.form.js') }}"></script>
    <script type="text/javascript" src="{{ asset('bundles/armdatlas/js/jquery.cookie.js') }}"></script>
    <script type="text/javascript" src="{{ asset('bundles/armdatlas/js/chosen.jquery.js') }}"></script>
    <script type="text/javascript" src="{{ asset('static/common/js/jquery.uniform.min.js') }}"></script>
    <script type="text/javascript" src="{{ asset('static/common/js/fancybox/jquery.fancybox.js') }}"></script>
   {# <script type="text/javascript" src="{{ asset('static/common/js/function.js') }}"></script> #}
    <script type="text/javascript" src="{{ asset('bundles/armdatlas/js/atlas_new.js') }}?v=123"></script>
    <script type="text/javascript">
        var fetchMarkersUri      = '{{ path('armd_atlas_default_filter') }}',
            fetchMarkerDetailUri = '{{ path('armd_atlas_default_objectballoon') }}',
            fetchClusterDetailUri = '{{ path('armd_atlas_default_clusterballoon') }}',
            bundleImagesUri      = '{{ asset('bundles/armdatlas/images') }}';

        $(function(){
            AT.init({
                map: 'map',
                center: [97.759578,63.44936],
                zoom: 3
            });
        });
    </script>
{% endblock %}
