{% extends '::base.html.twig' %}

{# ------------------------------------------------------------------------ #}
{% block body %}
    <div class="blocksection w" id="f-section">

        <form id="atlas-form" action="{{ path('armd_atlas_default_filter') }}" method="post">

            <div class="filter">
                <div class="title-block green-filter">
                    <h2>Фильтрация</h2>
                </div>
                <div class="filter-search-block">
                    <p class="filter-search-header">Поиск адреса</p>

                    <!-- #geocoder -->
                    <div id="geocoder" class="filter-search-form">
                        <div class="search-box">
                            <input class="search" name="q" type="text">
                            <button class="submit" type="submit" style="display:none;">Find</button>
                        </div>
                        <div class="result-box">
                        </div>
                    </div>
                    <!-- /#geocoder -->

                </div>
                <div class="filter-accordion">
                    <p class="filter-search-header">Фильтрация</p>
                    <div class="filter-accordion-block" id="filter">

{% set level = 0 %}
{% for node in categories %}
    {% if node.lvl == level %}
        </li>
    {% elseif node.lvl > level %}
        <ul class="lvl-{{ node.lvl }}">
    {% else %}
        </li>
        {% for i in 0..(level-node.lvl-1) %}
            </ul>
            </li>
        {% endfor %}
    {% endif %}

    <li>
        <label>
            <input type="checkbox" data-category="{{ node.id }}" name="category[{{ node.id }}]">
            {{ node.title }}
        </label>

    {% set level = node.lvl %}
{% endfor %}
{% for i in 0..level %}
    </li>
    </ul>
{% endfor %}

                    </div>
                </div>
            </div>
            <div class="atlas-center">
                <div class="title-block green">
                    <h2>Атлас</h2>
                </div>
                <div class="atlas-map">
                    <div id="map"></div>
                    <div class="atlas-menu"></div>
                </div>
            </div>

        </form>

    </div>
{% endblock %}

{# ------------------------------------------------------------------------ #}
{% block stylesheets %}
    {{ parent() }}
    {#
    <link rel="stylesheet" href="//ajax.googleapis.com/ajax/libs/jqueryui/1.8.18/themes/ui-lightness/jquery-ui.css">
    <link href="{{ asset('bundles/armdatlas/common/css/sm.css') }}" rel="stylesheet" type="text/css" media="screen" />
    #}
    {#вставил специально CSS - ниже строка
    <style>
        #nav{ margin: 0 auto 20px; }
    </style>
    <link href="/css/sm.css" rel="stylesheet" type="text/css" media="screen" />
    #}
    
    <link rel="stylesheet" href="{{ asset('bundles/armdatlas/css/atlas_new.css') }}">
{% endblock %}

{# ------------------------------------------------------------------------ #}
{% block javascripts %}
    {{ parent() }}
    <script src="//ajax.googleapis.com/ajax/libs/jqueryui/1.8.18/jquery-ui.min.js"></script>
    {# <script type="text/javascript" charset="utf-8" src="http://js.tmcrussia.com/map.js?{{ progorod_api_key }}&version=0.1.8-rc2"></script> #}
    <script type="text/javascript" charset="utf-8" src="http://js.tmcrussia.com/map.js?{{ progorod_api_key }}&version=0.1.7"></script>
    <script type="text/javascript" src="{{ asset('bundles/armdatlas/js/jquery.form.js') }}"></script>
    <script type="text/javascript" src="{{ asset('bundles/armdatlas/js/jquery.cookie.js') }}"></script>
    <script type="text/javascript" src="{{ asset('bundles/armdatlas/common/js/function.js') }}"></script>
    <script type="text/javascript" src="{{ asset('bundles/armdatlas/js/atlas_new.js') }}"></script>
    <script type="text/javascript">
        var fetchMarkersUri      = '{{ path('armd_atlas_default_filter') }}',
            fetchMarkerDetailUri = '{{ path('armd_atlas_default_objectballoon') }}',
            bundleImagesUri      = '{{ asset('bundles/armdatlas/images') }}';

        $(function(){
            AT.init({
                map: 'map',
                center: [97.759578,63.44936],
                zoom: 3
            });
        });
    </script>
{% endblock %}
