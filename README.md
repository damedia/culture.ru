# Создание нового проекта.
Для облегчения создания новых проектов, в системе репозиториев git.armd.ru загружен sandbox, содержащий в себе все необходимые конфигурации и зависимости CMS.

Все операции даны для ОС систем семейства linux, для windows команды могут отличаться.

Для того, что бы создать новый проект на основе CMS необходимо выполнить несколько действий:

1. Зайти на http://git.armd.ru/cmssandbox и убедится, что есть доступ к этому проекту.
2. В локальной директории проекта (например /www/example.com/) выполнить команду "git clone git@git.armd.ru:cmssandbox.git".
3. Обновить конфигурационный файл CMS выполнив "cp app/config/parameters.ini.dest app/config/parameters.ini", при необходимости поправить его, указав реальные данные БД (БД должна быть в кодировке utf8), локали и уникального ключа.
3. Установить/обновить используемые CMS модули (бандлы) CMS выполнив "php bin/vendors install --reinstall" (для работы этой команды пользователь из под которого выполняется команда должен иметь доступ ко всем зависимым репозиториям на git.armd.ru)
4. Обновить схему баз данных, выполнив команду "php app/console doctrine:schema:update --force"
5. Добавить администратора CMS выполнив в консоли "php app/console fos:user:create root --super-admin"
6. Опционально можно загрузить тестовую структуру страниц и данных используюя "php app/console doctrine:fixtures:load" (предварительно очищает бд, подробнее см. app/console help doctrine:fixtures:load)

Структура развернутого инстанса:

    ├── app # настройки текущего инстанса
    ├── bin # исполняемые скрипты
    ├── src # модули (бандлы) для данного инстанса
    ├── vendor #сторонние библиотки
    │   ├── assetic
    │   ├── bundles # сторонние модули (бандлы)
    │   │   ├── Armd # стандартные модули CMS
    │   │   ├── ... # другие модули Symfony2 
    │   ├── doctrine
    │   ├── ...
    │   ├── symfony
    │   ├── twig
    │   └── twig-extensions
    └── web # document-root веб сервера
        └── bundles # внешние ресурсы модулей (css, images, js)

# После установки sandbox
Для того, что бы разорвать связь с репозиторием sandbox (т.к. мы работаем с новым проектом) нужно выполнить след. действия.

1. Удаляем диреторию /www/example.com/.git
2. Заводим новый проект на git.armd.ru (например Example)
3. Инициализируем репозиторий в рабочей копии.
4. Добавляем git.armd.ru в рабочую копию "git remote add origin git@git.armd.ru:example.git"
5. Заливаем проект в общий репозиторий "git push origin master"